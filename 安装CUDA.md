# 安装CUDA以及

[TOC]

## 一、介绍：

​		CUDA（Compute Unified Device Architecture，统一计算设备架构）是由 NVIDIA 公司开发的**并行计算平台和编程模型**，它的核心作用是让开发者能够利用 NVIDIA GPU（图形处理器）的强大并行计算能力，实现对大规模计算任务的高效加速，而不仅仅局限于传统的图形渲染。

​		CUDA 本质是 NVIDIA 为自家 GPU 打造的 “通用计算接口”，它通过硬件（CUDA 核心）+ 软件（Toolkit）+ 编程模型的组合，让开发者能轻松利用 GPU 的并行计算能力，解决 CPU 难以高效处理的大规模并行任务。从 AI 训练到科学模拟，CUDA 已经成为高性能计算领域的核心基础设施，极大推动了需要海量算力的技术发展。





## 二、安装：

​		我们首先打开终端，输入以下命令查看GPU支持的最高的CUDA版本：

```
nvidia-smi
```

![23](/home/kk/pic/23.jpg)

​		如上图，我这里支持的最高版本为13.0；

https://developer.nvidia.com/cuda-toolkit-archive

​		我们点进上面的网址，找到自己对应的版本并且下载，如我这里选择的12.4：

![24](/home/kk/pic/24.jpg)

​		注意：我们需一步步点击绿色的选项，才会出现下一个选项；

​		在上面图片的最下面出现两行代码，为安装指令；

> CUDA 的安装位置需要分两部分理解：**核心组件（如 CUDA Toolkit、驱动）必须安装在系统环境中**，而**依赖 CUDA 的 Python 库（如 PyTorch、TensorFlow）可以安装在虚拟环境中**。

​		安装完，我们进行验证，命令行输入以下命令：

```
nvcc --version  # 或 nvcc -V
```

​		如果显示未查找到该命令，我们在输入：

```
ls /usr/local | grep cuda-12.4
```

​		如果有输出证明有安装，没输出则表示未安装；接着，我们进行环境变量配置，在主目录下找到.bashrc文件，再最后两行输入：

```
export PATH=/usr/local/cuda-12.4/bin:$PATH
export LD_LIBRARY_PATH=/usr/local/cuda-12.4/lib64:$LD_LIBRARY_PATH
```

​		然后保存退出；





## 三、安装cuda版本pytorch：

​		在此之前我们先来简单做一个对比，之前安装的这些软件分别有什么作用，在我们这里学习分别是什么角色；

|                        | conda                                                        | cuda                                                         | cuda-pytorch                                                 | isaacgym                                                     | mujoco                                                       |
| ---------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ | ------------------------------------------------------------ |
| 是什么                 | 跨平台的包管理器和环境管理器                                 | NVIDIA 开发的并行计算平台和编程模型（NVIDIA 显卡的 “加速外挂”，让显卡能并行干很多活） | 基于 CUDA 加速的 PyTorch 深度学习框架（带显卡加速的 PyTorch（搞深度学习的工具）） | NVIDIA 开发的 GPU 加速强化学习仿真环境（NVIDIA 做的 “强化学习高速训练场”） | 高精度物理仿真引擎                                           |
| 有什么作用             | 创建隔离的 Python 环境，管理依赖包，解决版本冲突问题（给每个项目隔出独立环境，防止软件版本冲突，方便管理依赖） | 利用 GPU 的并行计算能力加速大规模并行任务（如矩阵运算）（让显卡同时处理大量计算任务（比如算矩阵），速度比 CPU 快很多） | 提供 GPU 加速的张量计算、神经网络构建与训练能力，支持深度学习任务（让深度学习模型（神经网络）在显卡上加速训练 / 推理，跑起来更快） | 支持大规模并行的物理仿真，可同时训练数千个智能体，提升训练效率（能同时模拟成千上万个场景，让智能体批量训练，效率拉满） | 提供高精度刚体动力学仿真，模拟复杂机械系统的物理交互         |
| 在强化学习中扮演的角色 | 隔离强化学习项目的开发环境，管理依赖包（如 PyTorch、 Gym 等），确保环境可复现（给强化学习项目 “隔离环境”，确保每个项目的依赖（比如 PyTorch）不乱套，能复现结果） | 加速深度强化学习中神经网络的训练（如策略网络的大规模矩阵运算）（给强化学习里的神经网络 “加速”，让训练速度飞起来） | 实现深度强化学习算法（如 PPO、DQN）的核心框架，用于构建智能体的策略 / 价值网络，支持高效训练与推理（是强化学习智能体 “大脑”（策略 / 价值网络）的搭建工具，还能靠显卡加速让训练 / 推理更快） | 高效训练机器人控制、运动规划等任务的智能体，大幅提升训练效率（是训练机器人控制、运动规划等任务的 “高效练兵场”，能同时练大量智能体，效率超高） | 构建机器人控制、灵巧操作等任务的仿真环境，为强化学习智能体提供真实物理交互场景（给强化学习智能体造一个 “拟真训练场”，比如让机器人在里面练抓东西、走路，模拟真实物理交互） |

​		好了，现在我们已经基本了解这些工具的作用，具体一点可以在使用中详细了解；

​		现在我们开始安装pytorch；

- 先进入我们之前已经创建好的一个虚拟环境

- 然后我们开始下载我们cuda版本对应的pytorch：（如我这里为12.4）(这一步经常会失败，可以使用pip来进行安装,或者多试几次)

  ```
  conda install pytorch torchvision pytorch-cuda=12.4.0 -c pytorch -c nvidia
  ```

- 等待下载完成后，我们来验证一下：

  - 打开一个新的终端，进入我们刚刚安装pytorch的虚拟环境中，输入：

    ```
    python
    ```

  - 然后会进入python终端中，输入下面三行代码：

    界面类似这样：

    ```
    Python 3.10.12 (main, Jul  5 2023, 18:54:24) [GCC 11.2.0] on linux
    Type "help", "copyright", "credits" or "license" for more information.
    >>>
    ```

    `>>>` 就是输入代码的提示符。

    在 `>>>` 后逐条输入以下代码，每输完一行按回车：

    ```python
    import torch
    ```

    如果没报错（没出现 `ModuleNotFoundError: No module named 'torch'`），说明 PyTorch 安装成功。如果报错，可能是环境没激活对，或者安装时网络中断导致没装完，需要重新激活环境或重新安装。

    ```python
    print(torch.cuda.is_available())
    ```

    - **如果输出 `True`**：恭喜！PyTorch 已经能识别到你的 NVIDIA 显卡，CUDA 加速功能正常。
    - 如果输出 `False`：说明没找到 GPU，可能的原因：
      - 电脑没有 NVIDIA 显卡（CUDA 只支持 NVIDIA）；
      - 显卡驱动版本太低（CUDA 13.0 需要驱动≥525.x，去 NVIDIA 官网升级驱动）；
      - 安装的 PyTorch 是 “CPU 版本”（可能命令输错了，重新用 `pytorch-cuda=13.0` 安装）；
      - 环境没激活对（比如装到了 A 环境，却在 B 环境验证）。

    ```python
    print(torch.version.cuda)
    ```

    - **如果输出 `12.9`**：完美！安装的就是支持 CUDA 12.9 的版本，和你想要的一致。
    - **如果输出其他版本（比如 11.8）**：说明安装时版本没指定对，重新用 `pytorch-cuda=12.4` 命令安装即可。

现在我们就安装好了pytorch以及cuda了；